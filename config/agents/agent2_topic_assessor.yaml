# Agent 2: Topic Assessor Configuration
# Breaks down topics into subtopics/modules and estimates mastery levels

agent_metadata:
  name: "Topic Assessor"
  version: "2.0"
  description: "Analyzes topics, creates modules, estimates mastery based on user's background"

# LLM Settings
llm_config:
  model: "llama-3.3-70b-versatile"  # Default model from llm_engine
  temperature: 0.2                   # More deterministic for consistent assessment
  max_tokens: 4000                   # Higher limit for many topics with subtopics
  timeout_seconds: 60

# Module Structure
module_structure:
  modules_per_topic: 8               # Each topic has exactly 8 modules

  # Module progression (difficulty increases across modules)
  progression: "linear"              # Module 1 = easiest, Module 8 = hardest

  # Module naming convention
  naming_style: "descriptive"        # e.g., "Linear Algebra Foundations", "Matrix Operations"

# Mastery Estimation
mastery_estimation:
  # Base mastery estimation based on user's background
  baseline: 0                        # Default mastery if topic not mentioned

  # Adjustment factors
  factors:
    current_job_match: 30            # +30% if topic aligns with current job
    target_job_need: 20              # +20% if crucial for target job
    recent_completion: 50            # +50% if recently completed (within 30 days)

  # Mastery range
  min_mastery: 0
  max_mastery: 100

  # Round to nearest integer
  precision: 0

# Modules Complete Calculation
modules_complete:
  formula: "mastery * modules_per_topic * completion_factor"

  completion_factor: 0.01            # From thresholds.yaml

  # Examples:
  # mastery=0% → 0 modules complete
  # mastery=50% → 4 modules complete
  # mastery=100% → 8 modules complete

# Global Readiness Calculation
global_readiness:
  calculation_method: "weighted_average"

  # Weight topics based on importance to target role
  weighting:
    foundational: 1.5                # Foundational topics weighted more
    intermediate: 1.0
    advanced: 0.8

  # Round to 1 decimal place
  precision: 1

  # Readiness ranges
  ranges:
    not_ready: [0, 20]               # 0-20%: Not ready
    beginner: [21, 40]               # 21-40%: Beginner level
    developing: [41, 60]             # 41-60%: Developing
    proficient: [61, 80]             # 61-80%: Proficient
    expert: [81, 100]                # 81-100%: Expert

# Estimated Hours Calculation
estimated_hours:
  # Hours per topic based on mastery gap
  formula: "base_hours * (1 - mastery/100) * difficulty_multiplier"

  base_hours_per_topic: 20           # Baseline hours for a topic

  difficulty_multipliers:
    foundational: 0.8
    intermediate: 1.0
    advanced: 1.3

  # Minimum hours even if high mastery
  min_hours_per_topic: 2

  # Round to nearest integer
  precision: 0

# Topic Structure Requirements
topic_structure:
  input_fields:
    - "topic_id"
    - "topic_name"
    - "difficulty"
    - "prereq"

  output_fields:
    - "topic_id"
    - "topic_name"
    - "mastery"
    - "modules"
    - "modules_complete"
    - "estimated_hours"

# Module Output Structure
module_output:
  required_fields:
    - "module_id"
    - "module_name"

  example:
    module_id: 1
    module_name: "Statistical Basis"

# Validation
validation:
  check_module_count: true           # Ensure all topics have exactly 8 modules
  check_mastery_range: true          # Ensure mastery is 0-100
  check_required_fields: true        # Ensure all required fields present

# Recent Skills Integration
recent_skills:
  enabled: true
  source: "Agent 1 (Job Parser)"
  lookback_days: 30
  mastery_bonus: 50                  # Add 50% to mastery if recently completed

# Error Handling
error_handling:
  retry_on_json_error: true
  max_retries: 2

  # Fallback if LLM fails to generate modules
  fallback_module_names:
    - "Foundations"
    - "Core Concepts"
    - "Intermediate Topics"
    - "Advanced Techniques"
    - "Practical Applications"
    - "Real-World Examples"
    - "Expert Topics"
    - "Mastery"

# Logging
logging:
  log_mastery_estimation: true
  log_module_generation: true
  log_global_readiness: true
  log_validation_warnings: true
